<div class="min-h-screen bg-mlm-background">
  <main class="py-10">
    <div class="px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
      
      <!-- Page Header -->
      <div class="mb-10">
        <h1 class="text-3xl font-extrabold text-mlm-text tracking-tight mb-2">Marketplace</h1>
        <div class="h-px w-16 bg-mlm-primary/30 mb-4"></div>
        <p class="text-mlm-secondary text-sm">Browse our curated collection of premium products</p>
      </div>

      <app-filter-bar
        [searchQuery]="searchInput()"
        [sortOption]="sortOption()"
        [sortOptions]="sortOptions"
        [categories]="categories()"
        [selectedCategory]="selectedCategory()"
        (searchChange)="onSearchChange($event)"
        (sortChange)="onSortChange($event)"
        (categoryChange)="onCategorySelect($event)"
        (clearFilters)="onClearFilters()">
      </app-filter-bar>

      <!-- Results Count -->
      <div class="flex items-center justify-between mb-6">
        <p class="text-sm text-mlm-secondary">
          @if (searchQuery() || selectedCategory() !== 'all') {
            <span class="font-semibold text-mlm-text">{{ productCount() }}</span> of {{ totalProductCount() }} products
          } @else {
            <span class="font-semibold text-mlm-text">{{ productCount() }}</span> products
          }
        </p>
        @if (searchQuery() || selectedCategory() !== 'all') {
          <button
            (click)="onClearFilters()"
            class="text-xs font-semibold text-mlm-primary hover:text-mlm-primary/80 transition-colors flex items-center gap-1">
            <i class="pi pi-times text-[10px]"></i>
            Clear filters
          </button>
        }
      </div>

      <!-- Product Grid -->
      @if (isLoading()) {
        <!-- Loading Skeleton -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          @for (item of skeletonArray; track $index) {
            <div class="bg-white rounded-2xl overflow-hidden">
              <p-skeleton height="280px" styleClass="w-full"></p-skeleton>
              <div class="p-5 space-y-3">
                <div class="flex items-center justify-between">
                  <p-skeleton height="1.25rem" width="70%"></p-skeleton>
                  <p-skeleton height="1rem" width="15%"></p-skeleton>
                </div>
                <p-skeleton height="0.875rem" width="100%"></p-skeleton>
                <p-skeleton height="0.875rem" width="80%"></p-skeleton>
                <p-skeleton height="1.5rem" width="30%" styleClass="mt-2"></p-skeleton>
              </div>
            </div>
          }
        </div>
      } @else if (products().length === 0) {
        <!-- Empty State -->
        <div class="flex flex-col items-center justify-center py-20 text-center">
          <div class="w-24 h-24 bg-mlm-warm-100 rounded-full flex items-center justify-center mb-6">
            <i class="pi pi-shopping-bag text-4xl text-mlm-warm-400"></i>
          </div>
          @if (searchQuery()) {
            <h3 class="text-xl font-bold text-mlm-text mb-2">No results found</h3>
            <p class="text-mlm-secondary text-sm mb-6 max-w-md">
              We couldn't find any products matching "{{ searchQuery() }}". Try adjusting your search or browse categories.
            </p>
          } @else {
            <h3 class="text-xl font-bold text-mlm-text mb-2">No products available</h3>
            <p class="text-mlm-secondary text-sm mb-6 max-w-md">
              Check back soon! We're constantly adding new products to our marketplace.
            </p>
          }
          <div class="flex flex-wrap gap-3 justify-center">
            <button
              (click)="onClearFilters()"
              class="px-6 py-3 bg-mlm-text text-white rounded-xl text-sm font-semibold hover:bg-mlm-text/90 transition-colors">
              Browse all products
            </button>
            <button
              (click)="onExploreCategories()"
              class="px-6 py-3 bg-white text-mlm-text border border-gray-200 rounded-xl text-sm font-semibold hover:bg-gray-50 transition-colors">
              Explore categories
            </button>
          </div>
        </div>
      } @else {
        <!-- Products Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          @for (product of products(); track product.id) {
            <app-product-card
              [product]="product"
              (productClick)="onProductClick($event)">
            </app-product-card>
          }
        </div>
      }

    </div>
  </main>
</div>

